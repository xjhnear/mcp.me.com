<div class="box">
    <div class="actions">
        <table class="table-filter">
	        <tr>
	            <td>
	                <div class="controls">
					    <label class="radio inline">
				        <!--{{form_radio('keytype','id',keytype=='id')}}-->ID					        					        
				        </label>
				        <label class="radio inline">
				        <!--{{form_radio('keytype','title',keytype=='title')}}-->任务标题					        					        
				        </label>
					</div>				                
	            </td>
	            <td>
					<input id="keyword" type="text" class="input-medium" placeholder="" value="<!--{{keyword}}-->">								
				</td>
				<td>
					<input type="hidden" name="offline" id="offline" value="<!--{{offline}}-->">
					<input type="hidden" name="lineId" id="lineId" value="<!--{{lineId}}-->">
				    <a href="javascript:searchTask();" class="btn btn-teal">按条件搜索</a>
				</td>
			</tr>
		</table>
    </div>    
    <table class="table table-hover table-nomargin">
        <thead>
			<tr>
			    <th class="col-60">ID</th>
			    <th class="col-80">图标</th>
				<th class="col-150">任务标题</th>
				<th class="col-120">关联游戏</th>				
				<th class="table-btn-group">操作</th>
			</tr>
		</thead>
		<tbody>
		    <!--{%for item in datalist%}-->
			<tr>
				<td><!--{{item.taskId}}--></td>
				<td class="user-avatar"><img id="task_icon_<!--{{item.taskId}}-->" src="<!--{{item.taskIcon}}-->" class="" /></td>
				<td id="task_name_<!--{{item.taskId}}-->"><!--{{item.taskName}}--></td>
				<td><!--{{item.gname}}--></td>				
				<td>
				    <a href="javascript:void(0);" data-id="<!--{{item.taskId}}-->" class="btn btn-primary select-subtask-id">选择</a>				    							    
				</td>
			</tr>
			<!--{%endfor%}-->
		</tbody>
    </table>
    <div class="pagelink">
        <!--{{pagelinks}}-->
    </div>
</div>    
    <script>
    function searchTask()
    {
        var keytype = $("input[name='keytype']:checked").val();
        var keyword = $('#keyword').val();
        var offline = $("input[name='offline']").val();
        var lineId = $("input[name='lineId']").val();
        $.ajax({
            url:'/IOS_activity/task/subtask-pop-list',
            data:{keytype:keytype,keyword:keyword,lineId:lineId,offline:offline},
            dataType:'json',
            success:function(json){
                var html = '';
                html = json.html;
                $.dialog.list['pop-subtask-list'].content(html);		                
            }
        });
    }
    function init_page()
    {
        //
        $('.select-subtask-id').each(function(){
            $(this).click(function(){
                var task_id = $(this).attr('data-id');
                var task_name = $('#task_name_'+task_id).text();
                set_selected_subtask(task_id,task_name);
                $.dialog.list['pop-subtask-list'].close();
            });
        });
        //
        $('.pagelink a').each(function(){
            var url = $(this).attr('href');            
            $(this).attr('href','javascript:void(0);');
            $(this).click(function(){
                $.ajax({
                    url:url,
                    dataType:'json',
		            success:function(json){
		                var html = '';
		                html = json.html;
		                $.dialog.list['pop-subtask-list'].content(html);		                
		            }
                });
            });
            
        });
    }
    init_page();
    </script>