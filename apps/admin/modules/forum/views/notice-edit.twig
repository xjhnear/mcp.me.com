<!--{%extends "sub-layout-forum.twig"%}-->
<!--{%block main_content%}-->
<div class="row-fluid">
    <div class="span12">
		<div class="box">
			<div class="box-title">
				<h3><i class="icon-edit"></i>公告信息</h3>
			</div>
			<div class="box-content">
				<form id="notice" action="<!--{{url('forum/notice/save')}}-->" method="POST" class="form-horizontal form-validate">
				<input name="tid" type="hidden" value="<!--{{notice.tid}}-->" />
				<div class="control-group">
					<label for="textfield" class="control-label">公告类型</label>
					<div class="controls">
						<label class="checkbox inline"><!--{{form_checkbox('type',1,notice.type==0)}}-->全局公告</label>
					</div>
				</div>
				<div id="relation_game" class="control-group">
					<label class="control-label">关联的游戏</label>
					<div class="controls">
					    <div class="input-append">
					        <input id="selected_game_id" name="game_id" type="hidden" value="<!--{{notice.gid}}-->" />
						    <img id="selected_game_icon" alt=""  class="add-on" src="/static/img/wu_ss.gif" />
							<input type="text" id="selected_game_name" name="game_name" class="input-xlarge" value="<!--{{notice.shortgname}}-->" />
							<span class="add-on select-pop-game">选择游戏</span>
						</div>												
					</div>
				</div>
				<div class="control-group">
					<label for="textfield" class="control-label">社区广场置顶</label>
					<div class="controls">
					    <label class="radio inline"><!--{{form_radio('cid',-1,notice.cid==-1)}}-->全局置顶</label>
					    <label class="radio inline"><!--{{form_radio('cid',1,notice.cid==1)}}-->八卦吐槽置顶</label>
					    <label class="radio inline"><!--{{form_radio('cid',3,notice.cid==3)}}-->寻找伙伴置顶</label>
						<label class="radio inline"><!--{{form_radio('cid',2,notice.cid==2)}}-->游戏问答置顶</label>
						<label class="radio inline"><!--{{form_radio('cid',0,notice.cid==0)}}-->不置顶</label>
					</div>
				</div>							
				<div class="control-group">
					<label class="control-label">公告标题</label>
					<div class="controls">
						<input type="text" name="subject" class="input-xxlarge" value="<!--{{notice.subject}}-->" data-rule-required="true" data-msg-required="公告标题不能为空" />
					</div>
				</div>
				<div class="control-group">
					<label for="textfield" class="control-label">公告内容</label>
					<div class="controls">
					    <script id="container" name="format_message" type="text/plain"><!--{{notice.format_message}}--></script>
					</div>
				</div>
				<div class="form-actions">
					<button type="submit" class="btn btn-primary"><i class="icon-ok"></i>保存</button>
					<a href="<!--{{url('forum/notice-list')}}-->" class="btn btn-info">返回</a>
				</div>    
				</form>
			</div>
		</div>
    </div>
</div>
<!--{%endblock%}-->

<!--{%block footer_js%}-->
<script src="<!--{{asset('/static/js/ueditor/ueditor.config.js')}}-->"></script>
<script src="<!--{{asset('/static/js/ueditor/ueditor.all.js')}}-->"></script>
<script src="<!--{{asset('/static/js/ueditor/lang/zh-cn/zh-cn.js')}}-->"></script>
<script>

var editor = UE.getEditor('container');

var set_selected_game = function(game_id,game_name,icon){
    $('#selected_game_id').val(game_id);
    $('#selected_game_icon').attr('src',icon);
    $('#selected_game_name').val(game_name);
};
$(function(){
    $('input[name="type"]:checkbox').click(function(){
        if($(this).prop('checked')){
            $('#relation_game').hide();
        }else{
            $('#relation_game').show();
        }
    });
    $('.select-pop-game').bind('click',function(){        
        $.ajax({
            url:'/forum/api/game-search',
            dataType:'json',
            success:function(json){
                var html = '';
                html = json.html;
                $.dialog({id:'pop-game-list',title:'提示',padding:2,content:html,width:600,height:580});
            }
        });        
    });
    if($('input[name="type"]:checkbox').prop('checked')){
        $('#relation_game').hide();
    }else{
        $('#relation_game').show();
    }
});   
</script>
<!--{%endblock%}-->   