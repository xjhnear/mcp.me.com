<!--{%extends "base-layout.twig"%}-->
<!--{%block main_content%}-->
<div class="row-fluid">
    <div class="span12">
	    <div class="box box-color box-bordered">
			<div class="box-title">
				<h3>
					<i class="icon-table"></i>
					直播管理
				</h3>
				<div class="actions">
				    <form action="<!--{{url('yxvl_eSports/VltvLive/index')}}-->" class="">
				    <table class="table-filter">				        
				        <tr>
                            <!--
				            <td>标题关键词</td>
				            <td>
								<input name="keyword" type="text" class="input-medium" placeholder="关键字" value="<!--{{search.keyword}}-->">
							</td>
							<td><button class="btn btn-teal"><i class="icon-search"></i>搜索</button></td>
                            -->
							<td><a href="<!--{{url('yxvl_eSports/VltvLive/add')}}-->" class="btn btn-teal"><i class="icon-plus"></i>添加</a></td>
				        </tr>
				    </table>
				    </form>
				</div>
			</div>
			<div class="box-content nopadding">
			    <table class="table table-hover table-nomargin">
			        <thead>
						<tr>
							<th>图片</th>
                            <th>简介</th>
							<th class="col-150">开始时间</th>
                            <th class="col-150">结束时间</th>
							<th class="col-120">编辑者</th>
                            <th class="col-120">状态</th>
							<th class="table-btn-group">操作</th>
						</tr>
					</thead>
					<tbody>
					    <!--{%for item in datalist%}-->
						<tr>
                            <td class="table-list-img"><a href="#bigimg" data-toggle="modal"><img src="<!--{{item.imgUrl}}-->" /></a></td>
							<td>
								<!--{{item.summary}}-->
							</td>

							<td><!--{{item.startTime|date('Y-m-d H:i:s')}}--></td>
                            <td><!--{{item.endTime|date('Y-m-d H:i:s')}}--></td>
							<td><!--{{item.author}}--></td>
                            <td class="isOpen">
                                <!--{%if item.enable==0 %}-->
                                关闭
                                <!--{%else%}-->
                                开启
                                <!--{%endif%}-->
                            </td>
							<td>
                                <a href="#nogo" id="<!--{{item.id}}-->" class="btn btn-primary ajax-update"><!--{%if item.enable==0 %}-->开启<!--{%else%}-->关闭<!--{%endif%}--></a>
                                <a href="<!--{{url('yxvl_eSports/VltvLive/add')}}-->?id=<!--{{item.id}}-->" class="btn btn-primary">编辑</a>
                                <a href="<!--{{url('yxvl_eSports/VltvLive/live')}}-->?liveId=<!--{{item.id}}-->" class="btn btn-primary">查看图文</a>
							</td>
						</tr>
						<!--{%endfor%}-->
					</tbody>
			    </table>
			    <div class="pagelink">
			        <!--{{pagelinks}}-->
			    </div>			    
			</div>
		</div>
	</div>
</div>
<!--{%endblock%}-->

<!--{%block footer_js%}-->
<script>
$(function(){       
    $('a.ajax-del').bind('click',function(){
        if(confirm('确定要删除数据吗？')){
            var id = $(this).attr('id');
            obj = $(this);
            $.post('<!--{{url('yxvl_eSports/VltvLive/ajax-del')}}-->',{id:id,api:"RemoveLiveInfo"},function(data){
                if(data.success){
                    obj.parent().parent().hide();
                }else{
                    alert(data.error);
                }
            },"json")
        }
    });

    $('a.ajax-update').bind('click',function(){
        var notice = "";
        var enable = "";
        var val = "";
        var isOpen = "";
        if($(this).html()=="开启"){
            notice = "确定开启？";
            enable = "1";
            val = "关闭";
            isOpen = "开启"
        }else{
            notice = "确定关闭？";
            enable = "0";
            val = "开启";
            isOpen = "关闭"
        }
        if(confirm(notice)){
            var id = $(this).attr('id');
            obj = $(this);
            $.post('<!--{{url('yxvl_eSports/VltvLive/ajax-update')}}-->',{id:id,enable:enable,api:"RemoveLiveInfo"},function(data){
                if(data.success){
                    obj.html(val);
                    obj.parent().siblings(".isOpen").html(isOpen);
                }else{
                    alert(data.error);
                }
            },"json")
        }
    });
});    
</script>
<!--{%endblock%}-->