<!--{%extends "base-layout.twig"%}-->
<!--{%block header_css%}-->
<link rel="stylesheet" href="/static/css/validationEngine.jquery.css">
<!--{%endblock%}-->
<!--{%block main_content%}-->
<div class="row-fluid">
    <div class="span12">
	    <div class="box box-color box-bordered">
			<div class="box-title">
				<h3>
					<i class="icon-table"></i>多头条
				</h3>				
			</div>
			<div class="box-content">			    
			    <form id="form_topline" action="<!--{{url('wcms/home/add-topline')}}-->" method="POST" class='form-horizontal form-validate' enctype="multipart/form-data">
				<!--{%if setting.picUrl%}-->
			    <div class="control-group">
			        <label class="control-label">图片</label>
					<div class="controls">
					    <input name="picUrl" type="hidden" value="<!--{{setting.picUrl}}-->" />
					    <a href="#bigimg" data-toggle="modal"><img src="<!--{{setting.picUrl}}-->" width="150px" /></a>
					</div>
				</div>
				<!--{%endif%}-->
				<div class="control-group">
					<label class="control-label">上传图片</label>
					<div class="controls">
					    <div class="fileupload fileupload-new" data-provides="fileupload">
							<div class="input-append">
								<div class="uneditable-input span3"><i class="icon-file fileupload-exists"></i> <span class="fileupload-preview"></span></div><span class="btn btn-file"><span class="fileupload-new">选择图片</span><span class="fileupload-exists">Change</span><input type="file" name="filedata" /></span><a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
							</div>
						</div>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label">排序</label>
					<div class="controls">
					    <div class=" input-append">
							<input type="text" name="up" class="input-small" value="" />
						</div>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label">类型</label>
					<div class="controls">					    
				        <label class="radio inline">
				        <!--{{form_radio('type',1,true,{'class':'select-type','id':'type-station'})}}-->站内
				        </label>
				        <label class="radio inline">
				        <!--{{form_radio('type',2,false,{'class':'select-type','id':'type-url'})}}-->站外
				        </label>				        				        				     
					</div>
				</div>
				<div class="control-group div-type-1">
					<label class="control-label">关联文章</label>
					<div class="controls">
					    <div class="input-append">
							<input id="article_id" type="text" name="articleId" class="input-medium validate[condRequired[type-station]]" value="<!--{{setting.articleId}}-->" /><span class="add-on select-pop-article">选择</span>
						</div>
					</div>
				</div>
				<div class="control-group div-type-2">
					<label class="control-label">标题</label>
					<div class="controls">
					    <div class=" input-append">
							<input type="text" name="title" class="input-xxlarge validate[condRequired[type-url]]" value="<!--{{setting.title}}-->" />
						</div>
					</div>
				</div>
				<div class="control-group div-type-2">
					<label class="control-label">摘要</label>
					<div class="controls">
					    <textarea name="summary" class="input-xxlarge validate[condRequired[type-url]]"><!--{{setting.summary}}--></textarea>
					</div>
				</div>				
				<div class="control-group div-type-2">
					<label class="control-label">跳转URL</label>
					<div class="controls">
					    <div class=" input-append">
							<input type="text" name="url" class="input-xxlarge validate[condRequired[type-url]]" value="<!--{{setting.url}}-->" />
						</div>
					</div>
				</div>
				<div class="form-actions">
					<button type="submit" class="btn btn-primary"><i class="icon-ok"></i>保存</button>
				</div> 
			    </form>	    
			</div>
		</div>
	</div>
</div>
<!--{%endblock%}-->

<!--{%block footer_js%}-->
<script src="/static/js/jquery.validationEngine.js"></script>
<script src="/static/js/jquery.validationEngine-en.js"></script>
<script>
var set_selected_article = function(data_id){
    $('#article_id').val(data_id);
};

var set_selected_web_game = function(game_id,game_name,game_icon){
    $('#web_game_id').val(game_id);
};

$(function(){   

    $('input').iCheck({
		checkboxClass: 'icheckbox_square-orange',
		radioClass: 'iradio_square-orange',
		increaseArea: '20%' // optional
	});
	
	$('input').on('ifChecked', function(event){
	    if($(this).val()==1){
	        $('.div-type-1').show();
	        $('.div-type-2').hide()
	    }else{
	        $('.div-type-1').hide();
	        $('.div-type-2').show();
	    }
	});
    $('a.ajax-del').bind('click',function(){
        if(!confirm('确定要删除数据吗？')){
            return false;
        }
    });
    
    
    $('.select-pop-article').bind('click',function(){        
        $.ajax({
            url:'/wcms/api/pop-article-search',
            dataType:'json',
            success:function(json){
                var html = '';
                html = json.html;
                $.dialog({id:'pop-article-list',title:'提示',padding:2,content:html,width:600,height:580});
            }
        });        
    });
    
    $('.select-web-game').bind('click',function(){        
        $.ajax({
            url:'/wcms/api/pop-game-search',
            dataType:'json',
            success:function(json){
                var html = '';
                html = json.html;
                $.dialog({id:'pop-game-list',title:'提示',padding:2,content:html,width:600,height:580});
            }
        });        
    });
	$('#form_topline').validationEngine({promptPosition : "topRight",autoPositionUpdate:true});
    var div_type = $('input[name="type"]:checked').val();
    if(div_type==1){
        $('.div-type-1').show();
        $('.div-type-2').hide()
    }else{
        $('.div-type-1').hide();
        $('.div-type-2').show();
    }
});    
</script>
<!--{%endblock%}-->