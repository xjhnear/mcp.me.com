<!--{%extends "sub-layout-forum.twig"%}-->
<!--{%block main_content%}-->
<div class="row-fluid">
	<div class="span12">
		<div class="box">
			<div class="box-title">
				<h3>
					<i class="icon-edit"></i>
					编辑论坛
				</h3>
				<div class="actions">
				</div>
			</div>
			<div class="box-content">
				<form id="form-activity" action="<!--{{url('web_forum/forum/edit')}}-->" method="POST" class="form-horizontal form-validate" enctype="multipart/form-data">
					<input type="hidden" name="fid" value="<!--{{ finfo.fid }}-->">
					<div class="control-group">
						<label class="control-label">论坛名称</label>
						<div class="controls">
							<input type="text" name="forum_name" value="<!--{{ finfo.name }}-->" class="input" data-rule-required="true" data-msg-required="请填写论坛名称"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">关联游戏</label>
						<div class="controls">
							<div class="input-append">
								<input id="selected_game_id" name="gid" value="<!--{{ ginfo.gid }}-->" type="hidden"/>
								<img id="selected_game_icon" class="add-on" src="<!--{{ ginfo.ico ? ginfo.ico : '/static/img/wu_ss.gif' }}-->" />
								<input type="text" id="selected_game_name" name="game_name" readonly="readonly" value="<!--{{ ginfo.gname }}-->"
								       class="input input-medium" data-rule-required="true" data-msg-required="关联游戏不能为空" />
								<span class="add-on select-pop-game">选择游戏</span>
							</div>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Logo</label>
						<div class="controls">
							<div data-provides="fileupload" class="fileupload fileupload-new"><input type="hidden">
								<div style="max-width: 60px; max-height: 60px;" class="fileupload-new thumbnail"><img src="<!--{{ finfo.logo ? finfo.logo : '/static/img/wu_ss.gif' }}-->"></div>
								<div style="max-width: 60px; max-height: 60px; line-height: 20px;" class="fileupload-preview fileupload-exists thumbnail"></div>
								<span class="btn btn-file"><i class="icon-picture"></i>
									<span class="fileupload-new">选择图片</span><span class="fileupload-exists">变更</span>
									<input type="file" name="top_banner">
								</span>
								<span class="add-on text-warning">默认为游戏图片</span>
								<a data-dismiss="fileupload" class="btn fileupload-exists" href="#">移除</a>
							</div>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"></label>
						<div class="controls">
							<input type="submit" value="保存" class="btn btn-primary">
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<!--{%endblock%}-->
<!--{%block footer_js%}-->
<script>
$('input').iCheck({
	checkboxClass: 'icheckbox_square-orange',
	radioClass: 'iradio_square-orange',
	increaseArea: '20%' // optional
});
$("[class='my-checkbox']").bootstrapSwitch();
var set_selected_game = function(game_id,game_name,icon){
	$.get('/web_forum/forum/check-game-has-forum',{'gid':game_id},function(resp){
		if(resp.state){
			$('#selected_game_id').val(game_id);
			$('#selected_game_icon').attr('src',icon);
			$('#game_icon').val(icon);
			$('#selected_game_name').val(game_name);
		}else{
			alertify.error(resp.msg);
		}
	},'json');
};
$(function(){
    $('.select-pop-game').bind('click',function(){
        $.ajax({
            url:'/game/api/game-search',
            dataType:'json',
            success:function(json){
                var html = '';
                html = json.html;
                $.dialog({id:'pop-game-list',title:'提示',padding:2,content:html,width:600,height:580});
            }
        });
    });
});
</script>
<!--{%endblock%}-->